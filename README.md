<h1>Интерактивная карта зависимостей</h1>
Карта показывает зависимости компонента платформы ЕФС от других платформенных компонентов. Для каждой зависимости указано, что в компоненте зависит от неё - серверная  часть или клиентский модуль. В планах - добавить зависимости по OpenAPI (MM) и по АРМам администратора.
По клику на элементе диаграммы можно перейти на страницу соответствующего сервиса в CookBook ЕФС.

<h2>Генератор карт</h2>

Представляет собой простой скрипт на python, автоматически создающий карты зависимостей на основе матрицы зависимостей. Карта создается в формате mxGraph, используемом плагином draw.io для Confluence.

<h2>Создаем карты зависимостей в 4 простых шага</h2>
1. Ставим дистрибутив Anaconda для Python 3.x: https://www.anaconda.com/download. Если Вы знакомы с Python, в дополнение к Python 3.x нужны только  библиотеки pandas и numpy.

2. Берём скрипт: https://github.com/RomanShekhovtsov/depmap/dependency_maps_builder.py

3. Берём входные данные:
Server-side зависимости: server-side.xlsm
Зависимости клиентских библиотек: client-libs.xlsx
Метаданные: metadata.xlsx

4. Запускаем:
<pre>python dependency_maps_builder.py</pre>
А можно и так: 
<pre>dependency_maps_builder.py --metadata metadata.xlsx --server-side server-side.xlsm --client-libs client-libs.xlsx</pre>
Скрипт создаст xml-файлы в папке diagrams.

5. Содержимое  нужного файла вставляем в Confluence:
- В режиме редактирования страницы нажимаем в меню [+] и добавляем draw.io diagram
- В меню плагина draw.io выбираем Дополнительно->Редактировать схему.
- В появившемся окне заменяем xml на содержимое файла и нажимаем ОК.
- Сохраняем диаграмму draw.io.
- Сохраняем страницу.
Существующие диаграммы можно открывать на редактирование прямо со страницы Confluence через меню диаграммы.

<h2>Подготовка входных данных</h2>
- Server-side зависимости: server-side.xlsm. Заходим на Sharepoint, берем нужную версию сайзинг-модели, сохраняем как server-side.xml
- Зависимости клиентских библиотек: client-libs.xlsx. Заходим на <Confluence>, сохраняем таблицу в Excel. Проще всего сделать это через copy-paste. Confluence не умеет корректно класть в буфер обмена заголовки таблиц. Если менялся состав клиентских модулей, заголовок можно скопировать, зайдя в режим редактирования страницы в Confluence.
- Метаданные: metadata.xlsx

Если менялся состав компонент платформы, нужно отразить это в metadata.xlsx:
- name - имя ФП. Берите из колонки server-side name, если там пусто - из client-libs name.
- server-side name - имя должно соответствовать имени ФП в заголовке таблицы в server-side.xlsm.
- client-libs name - имя должно соответствовать имени компонента в заголовке таблицы в client-libs.xlsx, за вычетом комментариев в скобках. То есть часть строки до символов ' ('
- link - ссылка на страницу ФП в Cookbook ЕФС
 
